import import_resources


def os_info():
    if not import_resources.hosts:
        import_resources.host_dis()
        import_resources.os_dis()
    else:
        for host in import_resources.hosts:
            nm = import_resources.nmap.PortScanner()
            nm.scan(host[0], arguments='-O --osscan-guess')
            for h in nm.all_hosts():
                address = nm[h]['addresses']
                vendor = nm[h]['vendor']
                osmatch = nm[h]['osmatch']
                for osmatch in nm[h]['osmatch']:
                    print(f"Host {h} is running: {osmatch['name']}")
                    import_resources.os_array.append(osmatch['name'])
    import_resources.menu_exit()
