import import_resources

def report():
    reports_dir = import_resources.os.path.join(import_resources.os.path.expanduser("~/Documents"), "IoT_Vulnerability_Reports")
    folder_list = import_resources.os.listdir(reports_dir)

    for i, folder in enumerate(folder_list, start=1):
        print(f"{i}. {folder}")

    print(f"{len(folder_list) + 1}. Go back")  # Added Go back option for folders

    while True:
        folder_num = input("Enter the folder number: ")
        if folder_num.isdigit() and 1 <= int(folder_num) <= len(folder_list) + 1:
            break
        else:
            print("Invalid folder number. Please try again.")

    if int(folder_num) == len(folder_list) + 1:  # If Go back option is selected
        import_resources.main_menu(import_resources.no)
        return

    chosen_folder = folder_list[int(folder_num) - 1]
    chosen_folder_path = import_resources.os.path.join(reports_dir, chosen_folder)

    file_list = import_resources.os.listdir(chosen_folder_path)

    for i, file in enumerate(file_list, start=1):
        print(f"{i}. {file}")

    print(f"{len(file_list) + 1}. Go back")  # Added Go back option for files

    while True:
        file_num = input("Enter the file number: ")
        if file_num.isdigit() and 1 <= int(file_num) <= len(file_list) + 1:
            break
        else:
            print("Invalid file number. Please try again.")

    if int(file_num) == len(file_list) + 1:  # If Go back option is selected
        report()
        return

    chosen_file = file_list[int(file_num) - 1]
    chosen_file_path = import_resources.os.path.join(chosen_folder_path, chosen_file)

    with open(chosen_file_path, 'r') as f:
        print(f"Contents of {chosen_file}:")
        print(f.read())
    import_resources.menu_exit()
